# Marching Cubes
![Marching Cubes](https://github.com/AI-Sheet/EXP-MarchingCubes-Unity/blob/main/Photos/Preview.png?raw=true)

## Описание проекта
Высокопроизводительная система для создания процедурно генерируемых пещер в Unity с использованием алгоритма Marching Cubes и ускорением на GPU. Система создает реалистичные, разрушаемые пещерные среды, которые можно исследовать в реальном времени. Особый акцент сделан на генерации естественных пещерных систем с плавными переходами и разнообразной структурой.

## Технологический стек
- **Unity** - игровой движок для создания 3D-окружения
- **C#** - основной язык программирования
- **Compute Shaders** - для параллельных вычислений на GPU
- **OpenSimplex2V** - алгоритм шума для процедурной генерации
- **Marching Cubes** - алгоритм извлечения полигональной сетки из воксельных данных

## Основные компоненты

### Генератор пещер
Центральный компонент системы:
- Создает трехмерное поле плотности (SDF) для определения формы пещер
- Использует многослойный шум OpenSimplex2V для естественного вида пещер
- Контролирует вертикальность и ширину туннелей
- Обеспечивает целостность поверхности с естественными входами

### GPU-ускоренный Marching Cubes
Система визуализации:
- Выполняет вычисления на GPU через Compute Shader
- Использует многоэтапный конвейер для оптимизации
- Эффективно управляет памятью и буферами

### Чанковая система
Управление большими пещерными комплексами:
- Разделяет мир на управляемые чанки размером 32³ вокселя
- Динамически загружает и выгружает чанки вокруг игрока
- Использует алгоритм заливки для определения видимых пещерных проходов
- Кэширует недавно посещенные области для быстрого доступа

### Система разрушения
Интерактивное взаимодействие с окружением:
- Позволяет модифицировать пещеры в реальном времени
- Создает реалистичные обломки при разрушении
![Marching Cubes](https://github.com/AI-Sheet/EXP-MarchingCubes-Unity/blob/main/Photos/OpenView.png?raw=true)
## Система генерации пещер
Проект использует многоуровневый подход к созданию пещер:

- **Макро-уровень**: Формирование основных пещерных полостей
- **Микро-уровень**: Добавление деталей и неровностей
- **Система туннелей**: Создание связанных проходов между полостями
- **Поверхностная интеграция**: Формирование естественных входов в пещеры

Система использует многоэтапный конвейер для эффективной генерации меша:

1. **Генерация SDF**: Создание 3D-сетки значений плотности
2. **Подсчет треугольников**: Определение количества треугольников для каждого вокселя
3. **Префиксное сканирование**: Вычисление смещений для параллельной генерации
4. **Генерация вершин**: Создание геометрии на основе вычисленных смещений
5. **Сборка меша**: Формирование финального меша с оптимизацией

## Производительность

| Конфигурация | FPS | Память | Загрузка GPU | Полигоны/чанк |
|--------------|-----|--------|-------------|--------------|
| 32³ вокселей/чанк | 144+ | ~85MB | 25-35% | ~15K-25K |
| 64³ вокселей/чанк | 95+ | ~210MB | 45-55% | ~40K-60K |
| 128³ вокселей/чанк | 65+ | ~520MB | 65-75% | ~100K-150K |
| Мир 10x10x5 чанков | 85+ | ~450MB | 55-65% | ~1.5M-2M |

## Ключевые особенности

1. **Реалистичная генерация пещер**: Многослойный шум создает естественные формации
2. **Высокая производительность**: Оптимизированный GPU-конвейер обеспечивает плавный геймплей
3. **Интерактивность**: Полностью разрушаемая среда с реалистичной физикой
4. **Масштабируемость**: Система работает как для небольших пещер, так и для огромных комплексов

## Пример использования с процедурной рудой

![Marching Cubes](https://github.com/AI-Sheet/EXP-MarchingCubes-Unity/blob/main/Photos/ExampleUse.png?raw=true)
